# 设计思路差异

## React

1. 重运行时，死磕运行时
2. 思路是使用纯js写法，非常灵活，导致编译时很难做太多事情
3. 详细参见：[框架设计](../../1.React/1-react base/1-框架设计.md)



## Svelte

1. 重编译时，代码基本全部会解析成原生的 `DOM` 操作，性能也是最接近原生 `js` 的

## Vue

1. 在运行时和预编译取了一个很好地权衡，留了虚拟 `dom`，但是会通过响应式去控制虚拟 `dom` 的颗粒度
2. 在预编译里面，进行编译时优化，标记动态节点，做到了按需更新。

# 职责范围

1. Scope 职责范围：本质上，这个框架可以为你做多少事情

## React（小职责范围）

1. 自下而上设计，生态可以在核心概念上扩展更多；
2. 专注于提供非常基础的UI模型，
3. 专注提供更底层的原生实现（如可以通过一系列props来传递数据，返回vdom节点），开始可以接触更少，概念灵活性更高
4. 基于此你可以构建一套属于自己的抽象

### 缺点

1. 想用简单的概念去解释复杂的问题时，需要更多钻研工作，因此需要构建很多抽象概念，以便提高效率
2. 生态系统发展太坑导致碎片化和使用者流失，总是有新的idea，但为追求最完美解决办法，总是在变化



## Angular（大职责范围）

1. 自上而下设计，把用户可能用到的东西都考虑在内，如表单验证，动画等
2. 确保了自身与生态系统的一致性，遇到具体问题，无需从众多解决方案寻找最好的

### 缺点

1. 如果提供的功能不适用，想替换则非常困难

2. 为了保持一致性，底层的一些想法成本会更高，如果想使用底层想法时，会影响到项目的每个组件

   

## vue

1. 处于这两个职责范围之间，因此称之为渐进式框架，因此是分层设计（如不需要构建步骤，可以直接将js引入html中使用）
2. 低学习成本，让使用vue更专注于开发，而不是学习一些开发可能不需要的概念
3. 如你想使用路由，可以用官方提供的（只实现核心内容，非常干净），也可以自己实现



### 缺点

1. 虽然不是内置了router等保持一致性，但为了维持生态一致性，还是需要维护vuex，vue-router等，以保证整个生态一致性
2. 小职责范围会将问题抛给社区，寻求最优解，而vue则是提供满意的解决方案



# 渲染机制

1. 从操作层面很复杂，可以简单看为渲染函数JSX 与 Template（基于静态字符串的表达式），只是对同一个底层理念的不同策略表达

## JSX/VDOM

### 优点

1. 它们具有 JavaScript 的完整表现力，在组件上可以构建复杂逻辑
2. 允许在渲染组件时将视图层视为数据，返回节点表示当前状态的VDOM 节点，这个数据可以用于很多有意思的地方，如渲染到终端、PDF、Canvas、WebGL

### 缺点

1. 成本很高，需要遍历VDOM节点做Diff
2. 渲染函数的动态特性使得它难以优化，主要是js的动态特性，编译器不能hold所有可能发生的事
3. React 对这的解决方案就是不把重心放在加快 VDOM 本身的速度，而是如何提高感知性能，通过引入运行时调度并发时间切片的概念，但运行时，加载这块逻辑的js片段也要20、30KB



## 模板编译

### 优点

1. 模板是一种非常有约束的语言，你只能以某种方式去编写模板，因此允许编译器对你的意图做更多的预判，从而给它更多的空间去做执行优化。
2. 因为它不需要所有的复杂运行时调度来尝试让事情看起来更快



### 缺点

1. 受限于模板语法，从而失去 JavaScript 的表达能力。



## Vue

1. 结合VDOM与Template











# 问题

1. vue是如何解决io与cpu瓶颈的？

   - vue通过编译手段，走的是编译优化的路线，React走的是重运行时路线

2. 为什么 Vue 不需要时间分片（尤大的解释）：

   - 时间分片是为了解决 CPU 进行大量计算的问题，因为 React 本身架构的问题，在默认的情况下更新会进行过多的计算 
   - Vue 通过响应式依赖跟踪，在默认的情况下可以做到只进行组件树级别的更新计算，而默认下 React 是做不到的（据说 React 已经在进行这方面的优化工作了），再者 Vue 是通过 template 进行编译的，可以在编译的时候进行非常好的性能优化，比如对静态节点进行静态节点提升的优化处理，而通过 JSX 进行编译的 React 是做不到的
   - React 为了解决更新的时候进行过多计算的问题引入了时间分片，但同时又带来了额外的计算开销，就是任务协调的计算，虽然 React 也使用最小堆等的算法进行优化，但相对 Vue 还是多了额外的性能开销，因为 Vue 没有时间分片，所以没有这方面的性能担忧
   - 根据研究表明，人类的肉眼对 100 毫秒以内的时间并不敏感，所以时间分片只对于处理超过 100 毫秒以上的计算才有很好的收益，而 Vue 的更新计算是很少出现 100 毫秒以上的计算的，所以 Vue 引入时间分片的收益并不划算。

3. 双向数据绑定、响应式更新、单向数据流区别？

   - 响应式更新：状态与UI之间的关系，即状态变化如何映射到UI变化。
   - 单向数据流：当状态变化后，变化产生的影响只会从上往下传递。框架增加一些约束，解决一个状态变化后，究竟有多少组件会受影响。
   - 双向数据绑定：类似vue的v-model语法糖，状态+改变状态后触发的回调，是针对组件内发生的事

   

   
